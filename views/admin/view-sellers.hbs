<section id="ordersList" class="orders-section">
    <div class="page-container">
        <div class="page-header">
            <h1>Admin Dashboard</h1>
            <p>View platform overview and manage products</p>
        </div>

        <div class="orders-container">
            <table class="orders-table" id="productsTable">
                <thead>
                    <tr>
                        <th scope="col">No</th>
                        <th scope="col">Company Name</th>
                        <th scope="col">email</th>
                        <th scope="col">Options</th>

                    </tr>
                </thead>
                <tbody>
                    {{#each sellers}}
                    <tr>
                        <th scope="row">{{inc @index}}</th>
                        <td>{{this.companyName}}</td>
                        <td>{{this.email}}</td>
                        {{#if ../sellerList}}
                        <td>
                            {{#if this.suspend}}
                            <button class="action-btn view" onclick="revokeSeller('{{this._id}}')">Revoke</button>
                            {{else}}
                            <button class="action-btn track" onclick="suspendSeller('{{this._id}}')">Suspend</button>
                            {{/if}}
                            <button class="action-btn cancel"
                                onclick="removeSeller('{{this._id}}','{{this.companyName}}')">Remove</button>
                        </td>
                        {{else}}
                        <td>
                            <button class="action-btn view" onclick="approveSeller('{{this._id}}')">Approve</button>
                            <button class="action-btn cancel" onclick="rejectSeller('{{this._id}}')">Reject</button>

                        </td>
                        {{/if}}
                    </tr>
                    {{/each}}


                </tbody>
            </table>
        </div>
    </div>
</section>

<script>
    $(function () {
        $('#productsTable').DataTable();
    });
    function approveSeller(adminId) {
        $.ajax({
            url: '/admin/approve-seller',
            data: {
                adminId: adminId
            },
            method: 'post',
            success: (response) => {
                if (response.status) {
                    alert("Seller Approved")
                    $("#productsTable").load(" #productsTable");

                }
            }
        })
    }
    function rejectSeller(adminId, sellerName) {
        if (confirm('Are you sure you want to reject ' + sellerName + '?') == true) {
            $.ajax({
                url: '/admin/reject-seller',
                data: {
                    adminId: adminId
                },
                method: 'post',
                success: (response) => {
                    if (response.status) {
                        alert("Seller rejected")
                        $("#productsTable").load(" #productsTable");
                    }
                }
            })
        }

    }
    function suspendSeller(adminId) {
        $.ajax({
            url: '/admin/suspend-seller',
            data: {
                adminId: adminId
            },
            method: 'post',
            success: (response) => {
                if (response.status) {
                    alert("Seller suspended")
                    $("#productsTable").load(" #productsTable");
                }
            }
        })
    }
    function removeSeller(adminId, sellerName) {
        if (confirm('Are you sure you want to remove ' + sellerName + '?') == true) {
            $.ajax({
                url: '/admin/remove-seller',
                data: {
                    adminId: adminId
                },
                method: 'post',
                success: (response) => {
                    if (response.status) {
                        alert("Seller Removed")
                        $("#productsTable").load(" #productsTable");
                    }
                }
            })
        }

    }
    function revokeSeller(adminId) {
        $.ajax({
            url: '/admin/revoke-seller',
            data: {
                adminId: adminId
            },
            method: 'post',
            success: (response) => {
                alert("Seller Revoked")
                $("#productsTable").load(" #productsTable");
            }
        })
    }
</script>
